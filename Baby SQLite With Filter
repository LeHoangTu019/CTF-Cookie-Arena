Đây là source code xử lý chính của bài này:
